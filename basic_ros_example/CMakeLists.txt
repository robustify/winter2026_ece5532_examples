cmake_minimum_required(VERSION 3.5)
project(basic_ros_example)
set(CMAKE_CXX_STANDARD 20)

find_package(ament_cmake_auto REQUIRED)
ament_auto_find_build_dependencies()

# Generate messages
rosidl_generate_interfaces(${PROJECT_NAME}
  srv/Adder.srv
)
ament_export_dependencies(rosidl_default_runtime)
rosidl_get_typesupport_target(cpp_typesupport_target ${PROJECT_NAME} rosidl_typesupport_cpp)

# Topic publisher / subscriber node
ament_auto_add_executable(topic_publisher src/topic_publisher.cpp)

# Service advertiser node that depends on the autogenerated messages
ament_auto_add_executable(service_advertiser src/service_advertiser.cpp)
target_link_libraries(service_advertiser ${cpp_typesupport_target})

# Service client node that depends on the autogenerated messages
ament_auto_add_executable(service_client src/service_client.cpp)
target_link_libraries(service_client ${cpp_typesupport_target})

# Install Python executables where ros2 run can find them
install(
  PROGRAMS
    scripts/service_advertiser.py
    scripts/service_client.py
    scripts/topic_publisher.py
  DESTINATION lib/${PROJECT_NAME}
)

ament_auto_package()